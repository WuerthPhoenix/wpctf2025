#!/usr/bin/env python3

ENCODED_FLAG = b"\x86\x8e\xc1\x3c\x0f\x44\x55\x84\x12\x98\xdb\x30\x81\xfc\x98\xf8\x7f\x2f\x54\x9e\xae\xe5\xc7\x1d\x37\xd7\xa6\x56\x25\x72\x2b\x73\xc8\xef\x99\x5a\xd2\x8d\x41\x86\x37\x30\x27\x4a\x65\xb1\xbc\x03\x3c\xac\xd5\xd2\x99\x96\x93\x36\x22\x4c\x27\x7e\x12\x1a\x78\xbe\x01\x1f\xa7\xc4\x51\xf3\x29\x69\x39\x6d\x40\x4f\x98\x93\xd6\x7b\xee\xfd\x6f\xe7\x7a\x09\xd4\x9e\x5e\xe8\x14\x25\x93\x90\x58\x99\xe8\x95\xb2\x4b\xff\x66\x9b\x28\xfc\x48\x7f\x55\x55\x8d\x3d\x5f\x6f\x7e\xbf\xc7\x2b\x8d\x96\xb4\x73\x60\x66\xc8\x0b\x56\x11\x44\xc1\x91\xa3\xbe\xe0\xfb\xba\xc8\x40\xb9\x9f\xfb\x29\xe2\x15\x25\xbd\xd9\xcc\xd4\xee\x34\xdb\xa5\xd2\x9f\xd7\xd2\x9b\x1f\x4f\x2d\xf8\xb1\xb1\x4c\xc9\x7d\x9c\x6b\xc2\x79\x79\x4b\xc5\x3f\x2b\xf6"


def decode_flag(enc_flag: list[int]) -> bytes:
    result = []
    lVar10 = 0
    for i, enc in enumerate(enc_flag):
        lVar10 += 0x1337
        bVar3 = (i % 13) & 0x1F

        val = (enc - lVar10) & 0xFFFFFFFF
        val = ((val >> bVar3) | (val << (32 - bVar3))) & 0xFFFFFFFF
        b = (val * pow(0x7F3A21C9, -1, 2**32)) & 0xFF
        result.append(b)

    return bytes(result)


enc_flag_u32 = []
for i in range(0, len(ENCODED_FLAG), 4):
    enc_flag_u32.append(int.from_bytes(ENCODED_FLAG[i : i + 4], "little"))


flag = decode_flag(enc_flag_u32)
print(flag.decode())
